# Message Interactions - Visual Guide

## Desktop Experience

### Right-Click Context Menu
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Select            â”‚  <- Toggle message selection
â”‚ â„¹ï¸ Info              â”‚  <- Show message info (time, read status, user status)
â”‚ ğŸ“Œ Pin              â”‚  <- Pin message (placeholder)
â”‚ â¤ Forward           â”‚  <- Forward with "[Forwarded]:" prefix
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ—‘ï¸ Delete           â”‚  <- Delete (own messages only)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Message Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                â”‚
â”‚  [Reply Icon]  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚     (ğŸ‘ˆ)       â”‚  Replying to: Original message text...  â”‚   â”‚
â”‚                â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚   â”‚
â”‚                â”‚  My actual message content here         â”‚   â”‚
â”‚                â”‚                                2:30 PM âœ“âœ“â”‚   â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Reply Icon** (Desktop Only)
- Position: Fixed beside message (left or right)
- Visibility: On message hover
- Action: Sets reply context for next message

---

## Mobile Experience

### Long-Press Menu (500ms Hold)
```
When user holds message for 500ms:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ“ Select            â”‚
â”‚  â„¹ï¸ Info              â”‚
â”‚  ğŸ“Œ Pin              â”‚
â”‚  â¤ Forward           â”‚
â”‚  ğŸ—‘ï¸ Delete           â”‚  (own messages only)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Menu Positioning**: Bottom-center of screen (above keyboard)

### Simplified Info Display
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Message Info          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ• Sent      2:30 PM    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ“âœ“ Read      Read       â”‚
â”‚   (or "Not Read")       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸŸ¢ Status    Online      â”‚
â”‚   (or "Offline")        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        [Close]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Swipe-Left Reply Gesture
```
Message is swiped from left edge:

ğŸ‘ˆ [Reply Icon Appears]

â””â”€> Gesture triggers reply action
```

---

## Info Display Details

### What Shows in Info Box

| Element | Value | Color |
|---------|-------|-------|
| ğŸ• Sent Time | Extracted from timestamp (e.g., "2:30 PM") | Gray |
| âœ“âœ“ Read Status | "Read" if message is read, "Not Read" if not | Green/Gray |
| ğŸŸ¢ User Status | "Online" or "Offline" (shows online status) | Green/Gray |

**Example 1 - Message Read by Recipient:**
```
ğŸ• Sent        2:30 PM
âœ“âœ“ Read        Read
ğŸŸ¢ Status      Online
```

**Example 2 - Message Not Yet Read:**
```
ğŸ• Sent        3:45 PM
âœ“âœ“ Read        Not Read
ğŸŸ¢ Status      Offline
```

---

## Message Actions Behavior

### Select Multiple
- Click "Select" in menu
- Message gets ring highlight: `ring-2 ring-indigo-500`
- Multiple messages can be selected
- Future: Bulk delete/forward implementation

### Forward Message
- Copies message text
- Prepends: `[Forwarded]: `
- Sends as new message
- Shows: âœ“ Message forwarded (green toast)

### Delete Message
1. Click "Delete" in menu
2. Confirmation dialog appears: "Are you sure you want to delete this message?"
3. If confirmed:
   - Message text becomes: `[Message deleted]`
   - Message opacity: 50%
   - Shows: âœ“ Message deleted (red toast)
   - **Only sender can delete** (delete button hidden for others)

### Pin Message
- Click "Pin" in menu
- Shows: âœ“ Message pinned (green toast)
- **Future**: Pinned messages appear at chat top

---

## Responsive Behavior

### Desktop (â‰¥768px, md breakpoint)
```
âœ… Right-click context menu
âœ… Reply icon visible beside messages
âœ… Full menu options (Select, Info, Pin, Forward, Delete)
âœ… No touch handlers active
âœ… Hover effects visible
```

### Mobile (<768px)
```
âœ… Long-press (500ms) triggers menu
âœ… Menu positioned bottom-center
âœ… Reply icon hidden (use swipe-left gesture instead)
âœ… Touch-optimized button sizes
âœ… Simplified UI
âŒ Hover effects not applicable
```

---

## User Interaction Flow

### Desktop: Send + Reply
```
1. User types message
2. Clicks send button (arrow icon)
3. Message appears in chat
4. To reply:
   - Hover over message
   - Click reply icon (ğŸ‘ˆ) beside message
   - Reply bar appears: "Replying to: <text>"
   - Type reply
   - Send (reply linked in DB)
```

### Mobile: Send + Reply (via swipe)
```
1. User types message
2. Clicks send button
3. Message appears in chat
4. To reply:
   - Swipe message left
   - Reply action triggered
   - Reply bar appears
   - Type reply
   - Send
```

### Desktop: Delete Message
```
1. Hover over own message
2. Right-click on message
3. Context menu appears
4. Click "Delete"
5. Confirmation: "Are you sure?"
6. If YES:
   - Message shows "[Message deleted]"
   - Toast: âœ“ Message deleted
```

### Mobile: Delete Message
```
1. Long-press message (500ms)
2. Menu appears at bottom
3. Tap "Delete" (red, at bottom)
4. Confirmation dialog
5. If OK:
   - Message shows "[Message deleted]"
   - Toast: âœ“ Message deleted
```

---

## CSS Classes Used

| Class | Purpose |
|-------|---------|
| `message-item` | Container div for each message |
| `hidden md:flex` | Reply icon: hidden on mobile, visible on desktop |
| `md:hidden` | Swipe hint: hidden on desktop, visible on mobile |
| `group` | Enables group-hover effects |
| `ring-2 ring-indigo-500` | Visual highlight for selected messages |
| `animate-fade-in` | Toast notification fade-in effect |
| `animate-slide-up` | Mobile menu slide-up effect |

---

## Data Attributes

```html
<div class="message-item" 
     id="msg-{{ message.id }}"
     data-message-id="{{ message.id }}"
     data-message-text="{{ message.text|escapejs }}"
     oncontextmenu="showContextMenu(...)"
     ontouchstart="startLongPress(...)"
     ontouchend="cancelLongPress()">
```

- `id`: Used for DOM selection and scrolling
- `data-message-id`: Message UUID for tracking
- `data-message-text`: Safe text extraction (escaped)
- Event handlers: Right-click, long-press, touch-end

---

## Toast Notifications

### Success (Green)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Message forwarded          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Auto-dismisses after 2 seconds
```

### Delete (Red)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ Message deleted            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Auto-dismisses after 2 seconds
```

---

## Implementation Summary

| Feature | Desktop | Mobile |
|---------|---------|--------|
| **Context Menu** | Right-click | Long-press (500ms) |
| **Reply** | Icon button | Swipe-left |
| **Info Display** | Same as mobile | Simplified (time, read, status) |
| **Delete Confirmation** | Browser dialog | Browser dialog |
| **Menu Position** | At cursor | Bottom-center |
| **Own Message Indicator** | Delete button visible | Delete button visible |

---

## Next Steps / TODOs

- [ ] Implement actual swipe-left detection
- [ ] Add real-time user online/offline status
- [ ] Implement pin message display
- [ ] Add bulk operations with selected messages
- [ ] Add edit message functionality
- [ ] Add emoji reactions
- [ ] Add message search
- [ ] Add message export

